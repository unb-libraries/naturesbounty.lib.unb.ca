language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH
  - vendor/bin/dockworker deployment:logs:check $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: C0AL3O3JEwOtnO/TFBzOie7zhujfk27CjceUDYjbbo8RoO33qC/kGKdHjzlDkFKfmjUi7vEErU7/X3Btp16z2m6Tc+IOrU8WKqgr3cP+yMUqf/qqskMpw3G5H5rXG+dRt2rgQMhelvGpDHJeyLr2ajiwhwO9XRapfEj/KfRiZHhq1No3kTSAeSEG0gim0LzDsCxgV/LDtRoUfLgVQAe6Y2RJMDd9/EPd5o0FsG96hqlMZKJ2R2NO0gXTzGD6yOfU9571dEd5L8/KYToyeyglz3WK3JWPBPDIZSJh0StuC9lHnGP76v0s1sueVRWu2/jeYAxmoIay+VmwwHbXFQyEdxhKfEf0XvE6Z0sMDTnlJJeV//2sluZhvr1zib/AFequiklOQsNTkTsYjTRBuvlSmIN5dcgvY7Gb10EHe3nPUGgFUBUyQ0XnTu+92jA5DMqfD4tuaYb1ItCOb05GXyfF1YBDLN737DFXjqtzXT/Yx1VrUDFqp+0ljKla8vPcrgd4JY/7DKHk7hKQjDdStqTqXl1WTVxMK5d7lxdupY4GE4QpyuH3TAt40fUjaOE4qpwvqropkTRvTFpEg6eXLgPOB/qkDrqCMa5i2DOKli0aEMlZOd2CBXWEONvsrT73V5K62XgIcG1fVdcbA5EZ3v+PMJ+rHS7a2/JL0rSDaxsSqLU=
    on_start: always
    on_success: always
